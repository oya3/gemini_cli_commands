## gemini cli 拡張コマンド

```
.gemini
└── commands
    ├── docx2pdf.toml
    └── read_word.toml
```

### docx2pdf

指定したdocxファイルをpdfファイルに変換する
gemini から docx2pdf.ps1 が実行される

```ps1
/docx2pdf sample2020.docx
```

### /read_word

**失敗。この方法だとうまくいかない。。。**
wordを読み込んでbase64にして送信するサンプル
gemini から read_word.py が実行される

```ps1
/read_word sample2020.docx
```


## Wordファイルの解析・変換手法 比較

| 手法 | 内容 | メリット | デメリット |
| :--- | :--- | :--- | :--- |
| **PDF変換 (PowerShell/COM)** | Wordの機能でPDFに書き出し、そのバイナリをBase64で送信 | **図表・レイアウトが完璧に維持される**。人間が見るのと同じ状態でGeminiが視覚解析できるため、業務フローの理解に最適。 | Windows環境（Wordインストール済）が必要。変換処理に数秒のオーバーヘッドがある。 |
| **python-docx** | Pythonライブラリでxml構造からテキストのみを抽出 | 動作が高速で、Officeが未インストールの環境（Linux等）でも動く。テキスト情報の検索には強い。 | **図表やレイアウト情報が欠落する**。図の中の文字や、文章と図の位置関係がわからなくなるため、仕様書の解析には不向き。 |
| **Pandoc** | ドキュメント変換ツールを使用して形式変換 | 多くのフォーマットに対応している。 | 図表の再現性が低く、PDF化にはLaTeX等の複雑な環境構築が必要。日本語の文字化けリスクが高い。 |
| **テキスト直接貼り付け** | Wordを全選択してコピー＆ペースト | 最も手軽。 | 図表が一切反映されない。ページ数が多いとプロンプトの制限に抵触しやすく、構造が崩れる。 |

### 結論
**業務仕様書からテストケースを作成する場合**は、図表のコンテキストが不可欠なため、**「PowerShellによるPDF変換」**が最も精度が高く、推奨される手法です。
